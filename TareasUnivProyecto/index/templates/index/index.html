{% extends 'index/base.html' %}
{% load static %}
{% block content %}
{% load widget_tweaks %}
<head>
    <title>Inicio</title>
    <link rel="stylesheet" href="{% static 'css/index.css' %}">
</head>

<script>

    function clickBtnCalificado(id){
        var contenedor = document.getElementById('selector-'+id);
        if (contenedor.classList.contains('Checked')){
            desactivarCalificado(id);
        } else {
            activarCalificado(id);
        }
    }
    function activarCalificado(id){
        var contenedor = document.getElementById('selector-'+id);
        if (contenedor.classList.contains('NoChecked')){
            contenedor.classList.remove('NoChecked');
        }
        contenedor.classList.add('Checked');
        contenedor.style.backgroundColor="rgb(165, 244, 165)";
        document.getElementById('boton-interior-'+id).style.marginLeft="32px";

    }
    function desactivarCalificado(id){
        var contenedor = document.getElementById('selector-'+id);
        if (contenedor.classList.contains('Checked')){
            contenedor.classList.remove('Checked');
        }
        contenedor.classList.add('NoChecked');
        contenedor.style.backgroundColor="rgb(244, 165, 165)"
        document.getElementById('boton-interior-'+id).style.marginLeft="0px";
    }

</script>


<div id="contenedor-pagina">

    <!-- Contenedor para tareas que no se han comenzado -->
    <br><h2><strong onclick="colapsarContenedorTarea('Contenedor-Comenzar', 'titulo-comenzar-tarea', 'titulo-icon-comenzar')" class="titulo" id="titulo-comenzar-tarea" >Tareas sin comenzar <img class="titulo-icon" id="titulo-icon-comenzar" src="{%  static 'icons/icon-dropdown.png'  %}" alt=""></strong></h2>

    <div class="contenedor-contenedores " id="Contenedor-Comenzar">
        
            {% for tarea in formTareasPendientes %}

            <div class="contenedor-tarea" id="contenedor-tarea-{{tarea.id}}">
                
                {% for dias in diasRestantes %}

                    {% if dias.0 == tarea.id %}
                            
                        {% if dias.1 < 0 %}

                            <script>
                                document.getElementById("contenedor-tarea-"+'{{tarea.id}}').style.backgroundColor='rgb(255, 255, 255)'; 
                            </script>

                        {% elif dias.1 >= 0 %}
                                
                                {% if dias.1 <= 3 %}
                                
                                <script>
                                    document.getElementById("contenedor-tarea-"+'{{tarea.id}}').style.backgroundColor='var(--colorMuyPocoTiempo)'; 
                                </script>

                                {% elif dias.1 <= 7 %}

                                <script>
                                    document.getElementById("contenedor-tarea-"+'{{tarea.id}}').style.backgroundColor='var(--colorMedioTiempo)'; 
                                </script>
                        
                                {% else %}
                                <script>
                                    document.getElementById("contenedor-tarea-"+'{{tarea.id}}').style.backgroundColor= 'var(--colorSuficienteTiempo)'; 
                                </script>

                        {% endif %}
                    
                    {% endif %}

                {% endif %}

            {% endfor %}


                <div class="contenedor-curso-tarea">

                    <p  class="separacion"><strong>{{ tarea.curso }} - {{ tarea.tarea }}</strong></p>

                </div>

                <div>
                                        
                    <p >Valor: {{tarea.valor}} puntos</p>
        
                    <p class="separacion">Fecha de entrega: {{tarea.entrega}}</p> 

                    <div class="contenedor-dias-botones">


                        {% for dias in diasRestantes %}

                            {% if dias.0 == tarea.id %}
                            
                                {% if dias.1 < 0 %}

                                    <p>Plazo finalizado</p>
                                
                                {% else %}

                                    <p>{{ dias.1 }} Dias restantes</p>
                                
                                {% endif %}
                            
                            {% endif %}

                        {% endfor %}


                        <div class="botones">
                            
                            <div class="boton-icon-mensaje" onclick="scriptBackground('{{tarea.id}}')">
                                
                                <a id="mensaje-{{tarea.id}}" class="" data-bs-toggle="collapse" href="#expandir-{{tarea.id}}" aria-expanded="false" >
                                    
                                    <img class="botones-img" src="{% static 'icons/icon-topic.png' %}" alt="">
                                
                                </a>
                            
                            </div>

                            <div class="boton-icon-editar">
                                
                                <a href="{%  url 'editarTarea' tarea.id %}">
                                    
                                    <img class="botones-img" src="{% static 'icons/icon-edit.png' %}" alt="">
                                
                                </a>
                            
                            </div><br> <br>
                
                            <div>
                                
                                <a href="{%  url 'borrarCurso' tarea.id %}">
                                    
                                    <img class="botones-img" src="{% static 'icons/icon-borrar.png' %}" alt="">
                                
                                </a>
                            
                            </div><br> <br>
                            
                        </div>

                        <div class="" id="pantalla-desenfoque" ></div>

                        <div class="collapse collapse1 "  id="expandir-{{tarea.id}}">

                            <div class="menu-anotaciones">
                            
                                <div onclick="noScriptBackground('{{tarea.id}}')" >
                                    
                                    <img class="botones-img" src="{% static 'icons/icon-cancel.png' %}" alt="">
                                
                                </div>

                            </div>
    
                            <div class="contenedor-contenido-anotacion" >
                                
                                <div id="anotacion-actual-{{tarea.id}}" >

                                    {% if tarea.anotacion == "" %}

                                        <p class="no-anotaciones">No hay anotaciones</p>

                                    {% else %}

                                        <textarea class="si-anotaciones" disabled>{{tarea.anotacion}}</textarea>
                                        
                                    {% endif %}
                                    
                                    
                                    <div class="contenedor-boton-editar">

                                        <button class="boton-sin-estilo" onclick="AbrirEditor('{{tarea.id}}')"> 
                                            
                                            <img class="botones-img" src="{% static 'icons/icon-edit.png' %}" alt="">
                                        
                                        </button>

                                    </div>

                                </div>

                                <form id="id-form-anotacion-{{tarea.id}}" action="/actualizarAnotacion/" method="POST">

                                    {% csrf_token %}

                                    <div id="field-anotacion-{{tarea.id}}" >

                                        <textarea name="anotacion" maxlength="10000" placeholder="{{tarea.anotacion}}" class="form-control textarea-anotacion" required id="id_anotacion">{{tarea.anotacion}}</textarea>

                                        <input type="hidden" value="{{tarea.id}}" name="id">

                                    </div>

                                    <div class="contenedor-botones-ok-cancel">

                                        <button type="submit" class="boton-sin-estilo">
                                            
                                            <img class="botones-img" src="{% static 'icons/icon-ok.png' %}" alt="">
                                        
                                        </button>

                                        <a onclick="noScriptBackground('{{tarea.id}}')"><img class="botones-img" src="{% static 'icons/icon-cancel.png' %}" alt=""></a>

                                        <input type="reset" style="display: none;" id="reset-btn-{{tarea.id}}">

                                    </div>
                                </form>


                              </div>    
    
                        </div>
                        
                        
                    </div>
                    

                </div>
                
                

            </div>

            {% endfor %}        

    </div>

    <br><h2><strong class="titulo" onclick="colapsarContenedorTarea('Contenedor-Proceso', 'titulo-proceso-tarea', 'titulo-icon-proceso')" id="titulo-proceso-tarea">Tareas en proceso <img class="titulo-icon" id="titulo-icon-proceso" src="{%  static 'icons/icon-dropdown.png'  %}" alt=""></strong></h2> 




 <!--  ---------------------------------------------------------  -->



    <div class="contenedor-contenedores" id="Contenedor-Proceso">
        
            {% for tarea in formTareasProceso %}

            <div class="contenedor-tarea" id="contenedor-tarea-{{tarea.id}}">
            
                {% for dias in diasRestantesProceso %}

                        {% if dias.0 == tarea.id %}
                        
                            {% if dias.1 < 0 %}

                                <script>
                                    document.getElementById("contenedor-tarea-"+'{{tarea.id}}').style.backgroundColor='rgb(255, 255, 255)'; 
                                </script>

                            {% elif dias.1 >= 0 %}
                                    
                                    {% if dias.1 <= 3 %}
                                    
                                    <script>
                                        document.getElementById("contenedor-tarea-"+'{{tarea.id}}').style.backgroundColor='var(--colorMuyPocoTiempo)'; 
                                    </script>

                                    {% elif dias.1 <= 7 %}

                                    <script>
                                        document.getElementById("contenedor-tarea-"+'{{tarea.id}}').style.backgroundColor='var(--colorMedioTiempo)'; 
                                    </script>
                            
                                    {% else %}
                                    <script>
                                        document.getElementById("contenedor-tarea-"+'{{tarea.id}}').style.backgroundColor= 'var(--colorSuficienteTiempo)'; 
                                    </script>

                            {% endif %}
                        
                        {% endif %}

                    {% endif %}

                {% endfor %}

                    <div class="contenedor-curso-tarea">

                        <p  class="separacion"><strong>{{ tarea.curso }} - {{ tarea.tarea }}</strong></p>
    
                    </div>
    
                    <div>
                                            
                        <p >Valor: {{tarea.valor}} puntos</p>
            
                        <p class="separacion">Fecha de entrega: {{tarea.entrega}}</p> 
    
                        <div class="contenedor-dias-botones">

                            {% for dias in diasRestantesProceso %}

                                {% if dias.0 == tarea.id %}
                                
                                    {% if dias.1 < 0 %}

                                        <p>Plazo finalizado</p>
                                    
                                    {% endif %}

                                    {% if dias.1 >= 0 %}

                                        <p>{{ dias.1 }} Dias restantes</p>
                                    
                                    {% endif %}

                                {% endif %}

                            {% endfor %}

                            <div class="botones">
                            
                                <div class="boton-icon-mensaje" onclick="scriptBackground('{{tarea.id}}')">
                                    
                                    <a id="mensaje-{{tarea.id}}" class="" data-bs-toggle="collapse" href="#expandir-{{tarea.id}}" aria-expanded="false">
                                        
                                        <img class="botones-img" src="{% static 'icons/icon-topic.png' %}" alt="">
                                    
                                    </a>
                                
                                </div>
    
                                <div class="boton-icon-editar">
                                    
                                    <a href="{%  url 'editarTarea' tarea.id %}">
                                        
                                        <img class="botones-img" src="{% static 'icons/icon-edit.png' %}" alt="">
                                    
                                    </a>
                                
                                </div><br> <br>
                    
                                <div>
                                    
                                    <a href="{%  url 'borrarCurso' tarea.id %}">
                                        
                                        <img class="botones-img" src="{% static 'icons/icon-borrar.png' %}" alt="">
                                    
                                    </a>
                                
                                </div><br> <br>
                                
                            </div>

                        <div class="" id="pantalla-desenfoque" ></div>

                        <div class="collapse collapse1 "  id="expandir-{{tarea.id}}">

                            <div class="menu-anotaciones">
                            
                                <div onclick="noScriptBackground('{{tarea.id}}')" >
                                    
                                    <img class="botones-img" src="{% static 'icons/icon-cancel.png' %}" alt="">
                                
                                </div>

                            </div>
    
                            <div class="contenedor-contenido-anotacion" >
                                
                                <div id="anotacion-actual-{{tarea.id}}" >

                                    {% if tarea.anotacion == "" %}

                                    <p class="no-anotaciones">No hay anotaciones</p>

                                    {% else %}

                                    <textarea class="si-anotaciones" disabled>{{tarea.anotacion}}</textarea>
                                    
                                    {% endif %}
                                    
                                    
                                    <div class="contenedor-boton-editar">

                                        <button class="boton-sin-estilo" onclick="AbrirEditor('{{tarea.id}}')"> 
                                            
                                            <img class="botones-img" src="{% static 'icons/icon-edit.png' %}" alt="">
                                        
                                        </button>

                                    </div>

                                </div>

                                <form id="id-form-anotacion-{{tarea.id}}" action="/actualizarAnotacion/" method="POST">

                                    {% csrf_token %}

                                    <div id="field-anotacion-{{tarea.id}}" >

                                        <textarea name="anotacion" maxlength="10000" placeholder="{{tarea.anotacion}}" class="form-control textarea-anotacion" required id="id_anotacion">{{tarea.anotacion}}</textarea>

                                        <input type="hidden" value="{{tarea.id}}" name="id">

                                    </div>

                                    <div class="contenedor-botones-ok-cancel">

                                        <button type="submit" class="boton-sin-estilo">
                                            
                                            <img class="botones-img" src="{% static 'icons/icon-ok.png' %}" alt="">
                                        
                                        </button>

                                        <a onclick="noScriptBackground('{{tarea.id}}')"><img class="botones-img" src="{% static 'icons/icon-cancel.png' %}" alt=""></a>

                                        <input type="reset" style="display: none;" id="reset-btn-{{tarea.id}}">

                                    </div>
                                    
                                </form>


                              </div>    
    
                        </div>
                        
                        
                    </div>
                    

                </div>
                
                

            </div>


            {% endfor %}        

    </div>

    <br><h2><strong onclick="colapsarContenedorTarea('Contenedor-Terminado', 'titulo-terminado-tarea', 'titulo-icon-terminado')" id="titulo-terminado-tarea" class="titulo">Tareas terminadas <img class="titulo-icon" id="titulo-icon-terminado" src="{%  static 'icons/icon-dropdown.png'  %}" alt=""></strong></h2> 

    <!--  ---------------------------------------------------------  -->

       <div class="contenedor-contenedores" id="Contenedor-Terminado" style="margin-bottom: 30px;">
           
               {% for tarea in formTareasTerminadas %}
               
                <div class="contenedor-tarea" id="contenedor-tarea-{{tarea.id}}">
                    
                    <script> document.getElementById("contenedor-tarea-"+"{{tarea.id}}").style.backgroundColor='rgb(255, 255, 255)';  </script>
   
                       <div class="contenedor-curso-tarea">
   
                           <p  class="separacion"><strong>{{ tarea.curso }} - {{ tarea.tarea }}</strong></p>
       
                       </div>
       
                       <div>
                                               
                           <p >Valor: {{tarea.valor}} puntos</p>
               
                           <p class="separacion">Fecha de entrega: {{tarea.entrega}}</p> 
       
                           <div class="contenedor-dias-botones">
   
                                <div class="boton-agregar-calificacion" >
                                        
                                        <p>Calificado:</p>

                                        <div class="selector-calificacion" id="selector-{{tarea.id}}" onclick="clickBtnCalificado('{{tarea.id}}')">


                                            <div class="boton-interior" id="boton-interior-{{tarea.id}}">

                                            </div>

                                        </div>

                                        <script>
                                            var status = '{{tarea.calificado}}';
                                            var id = '{{tarea.id}}'
                                            if (status=="True"){
                                                activarCalificado(id)
                                            } else {
                                                desactivarCalificado(id)
                                            }

                                        </script>
                                        <form action="">

                                            <div class="fondo-pregunta" style="display: none;" id="fondo-pregunta-{{tarea.id}}">
                                                <div class="mensaje-pregunta position-fixed top-50 start-50 translate-middle">
                                                    <p>Seguro que desea continuar?</p>
                                                    <div>
                                                        <button class="boton-sin-estilo" type="submit"><img class="botones-img" src="{% static 'icons/icon-ok.png' %}" alt=""></button>
                                                        <a href="{% url 'inicio' %}"><img class="botones-img" src="{% static 'icons/icon-cancel.png' %}" alt=""></a>

                                                    </div>
                                                </div>
    
                                            </div>
                                        </form>
                                </div>
   
                                <div class="botones">
                                    
                                    
                            
                                    <div class="boton-icon-mensaje" onclick="scriptBackground('{{tarea.id}}')">
                                        
                                        <a id="mensaje-{{tarea.id}}" class="" data-bs-toggle="collapse" href="#expandir-{{tarea.id}}" aria-expanded="false">
                                            
                                            <img class="botones-img" src="{% static 'icons/icon-topic.png' %}" alt="">
                                        
                                        </a>
                                    
                                    </div>
        
                                    <div class="boton-icon-editar">
                                        
                                        <a href="{%  url 'editarTarea' tarea.id %}">
                                            
                                            <img class="botones-img" src="{% static 'icons/icon-edit.png' %}" alt="">
                                        
                                        </a>
                                    
                                    </div><br> <br>
                        
                                    <div>
                                        
                                        <a href="{%  url 'borrarCurso' tarea.id %}">
                                            
                                            <img class="botones-img" src="{% static 'icons/icon-borrar.png' %}" alt="">
                                        
                                        </a>
                                    
                                    </div><br> <br>
                                    
                                </div>
        
                                <div class="" id="pantalla-desenfoque" ></div>

                                <div class="collapse collapse1 "  id="expandir-{{tarea.id}}">
        
                                    <div class="menu-anotaciones">
                                    
                                        <div onclick="noScriptBackground('{{tarea.id}}')" >
                                            
                                            <img class="botones-img" src="{% static 'icons/icon-cancel.png' %}" alt="">
                                        
                                        </div>
        
                                    </div>
            
                                    <div class="contenedor-contenido-anotacion" >
                                        
                                        <div id="anotacion-actual-{{tarea.id}}" >
        
                                            {% if tarea.anotacion == "" %}
        
                                                <p class="no-anotaciones">No hay anotaciones</p>
        
                                            {% else %}
        
                                                <textarea class="si-anotaciones" disabled>{{tarea.anotacion}}</textarea>
                                                
                                            {% endif %}
                                            
                                            
                                            <div class="contenedor-boton-editar">
        
                                                <button class="boton-sin-estilo" onclick="AbrirEditor('{{tarea.id}}')"> 
                                                    
                                                    <img class="botones-img" src="{% static 'icons/icon-edit.png' %}" alt="">
                                                
                                                </button>
        
                                            </div>
        
                                        </div>
        
                                        <form id="id-form-anotacion-{{tarea.id}}" action="/actualizarAnotacion/" method="POST">
        
                                            {% csrf_token %}
        
                                            <div id="field-anotacion-{{tarea.id}}" >
        
                                                <textarea name="anotacion" maxlength="10000" placeholder="{{tarea.anotacion}}" class="form-control textarea-anotacion" required id="id_anotacion">{{tarea.anotacion}}</textarea>
        
                                                <input type="hidden" value="{{tarea.id}}" name="id">
        
                                            </div>
        
                                            <div class="contenedor-botones-ok-cancel">
        
                                                <button type="submit" class="boton-sin-estilo">
                                                    
                                                    <img class="botones-img" src="{% static 'icons/icon-ok.png' %}" alt="">
                                                
                                                </button>
        
                                                <a onclick="noScriptBackground('{{tarea.id}}')"><img class="botones-img" src="{% static 'icons/icon-cancel.png' %}" alt=""></a>
        
                                                <input type="reset" style="display: none;" id="reset-btn-{{tarea.id}}">
        
                                            </div>
                                        </form>
        
        
                                      </div>    
            
                                </div>
                                
                                
                            </div>
                            
        
                        </div>
                        
                        
        
                    </div>
   
   
               {% endfor %}        
   
       </div>
   
<div id="botones">
    
    <div class="boton-desplegar boton-desplegar-agregar">
    
        <a class="sin-decoracion" href="{% url 'agregarTarea' %}" >
    
            <div style="display: flex;">
    
                <div id="icon-agregar">
    
                    <p> + </p>
            
                </div>
    
                <div class="agregar-texto" >
    
                    <div ><p>Agregar</p></div>
    
                </div>
            
            </div>
            
        </a>
    
    </div>

    <div class="boton-desplegar boton-desplegar-reporte">

        <a class="sin-decoracion" href="#abrir-reportes">
        
            <div style="display: flex; width: 180px;">

                <div class="img-bugs">

                    <img src="{% static 'icons/icon-bug.png' %}" style="width: 30px; height: 30px;" alt="">

                </div>

                <div class="agregar-texto">

                    <div><p>Reportar un bug</p></div>

                </div>

            </div>
            
        </a>

    </div>

</div>


</div>

<script type="text/javascript">

    function scriptBackground(name_id) {

        document.getElementById("pantalla-desenfoque").classList.add("desenfoque");

        document.getElementById("id-form-anotacion-"+name_id).style.display="none";

        document.getElementById("anotacion-actual-"+name_id).style.display="block";

        document.getElementById("reset-btn-"+name_id).click();    
    }

    function noScriptBackground(name_id) {

        document.getElementById("mensaje-"+name_id).click();

        document.getElementById("pantalla-desenfoque").classList.remove("desenfoque");

        document.getElementById("expandir-"+name_id).classList.remove("sobreponer");

        document.getElementById("anotacion-actual-"+name_id).style.display="none";
    }

    function AbrirEditor(name_id) {
        
        document.getElementById("anotacion-actual-"+name_id).style.display="none";

        document.getElementById("id-form-anotacion-"+name_id).style.display="block";
    }

    function colapsarContenedorTarea(contenedor, titulo, icon){
        var elemento = document.getElementById(contenedor);
        var titulo_elemento = document.getElementById(titulo);
        var icon_titulo = document.getElementById(icon);

        if (elemento.classList.contains('colapsar-css')){
            
            elemento.classList.remove('colapsar-css')
            titulo_elemento.style.opacity="100%";
            icon_titulo.style.transform= 'rotate(180deg)';

        } else {

            elemento.classList.add('colapsar-css')
            titulo_elemento.style.opacity="50%";
            icon_titulo.style.transform= 'rotate(0deg)';

        }

    }

</script>

{% endblock content %}